var scrollToPos,submitContactUsForm,recaptchaInited=!1,grec_public_key="6LfqXcUUAAAAAKo-s4047w0_nifG8y6-tAIbb9WP",formSubmitUrl="https://www.ieltstaipei.com/api/getContactUsForm";function appearOtherCourses(){var e=document.getElementById("otherCoursesButton");document.getElementById("otherCourses").classList.remove("d-none"),e.classList.add("d-none")}(simpleValidate=new simpleValidateForm("contactUsForm")).validateFieldName=[["nameEnglishFirst",["text","請填入您的英文名字"],"require_if_no","nameChineseFirst"],["nameEnglishLast",["text","請填入您的英文姓氏"],"require_if_no","nameChineseLast"],["nameChineseFirst",["text","請填入您的中文名字"],"require_if_no","nameEnglishFirst"],["nameChineseLast",["text","請填入您的中文姓氏"],"require_if_no","nameEnglishLast"],["YourGender",["select","請選擇您的性別"],"",""],["mobile",["text","請填寫您的行動電話號碼"],"required",""],["email",["text","請填入您的電子郵件信箱"],"required",""],["askCourse",["checkbox","請填入您想要詢問的課程"],"",""],["comment",["textarea","請問您想問的問題內容"],"",""],["csrf_token",["hidden",""],"",""],["fpid",["hidden",""],"",""],["refer",["hidden",""],"",""],["g-recaptcha-response",["hidden",""],"",""],],simpleValidate.init(),document.addEventListener("DOMContentLoaded",function(){$("#collapseContactUs").on("hide.bs.collapse",function(e){e.preventDefault()}),window.scrollToPos=function(e){void 0!==$("#"+e).offset().top&&(window.initReCaptcha(),$("html, body").animate({scrollTop:$("#"+e).offset().top},"150","easeInOutQuad"))},window.initReCaptcha=function(){var e=document.createElement("script");e.onload=function(){window.grecaptcha.ready(function(){console.log("recaptcha ready!")})},e.src="https://www.google.com/recaptcha/api.js?render="+grec_public_key,document.head.append(e)},window.initReCaptcha();var e=!1;window.submitContactUsForm=function(){if(!e){if(e=!0,!window.simpleValidate.getFormValidateResult()){e=!1;return}ge("contact_submit_start");var t=document.querySelector("#model_close_btn"),s=document.querySelector("#systemInfo");s.querySelector(".modal-body").innerHTML='<div style="height: 150px;"><svg class="circular" width="48px" height="48px"> <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" /> <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg></div>',t.style.display="none",window.grecaptcha.execute(grec_public_key,{action:"homepage"}).then(function(o){$("#g-recaptcha-response").val(o),$("#refer").val(encodeURIComponent(window.location.href));var a=document.cookie.split("; ").find(e=>e.startsWith("fi="))?.split("=")[1]||!1,i=document.cookie.split("; ").find(e=>e.startsWith("uh="))?.split("=")[1]||!1,r=a?`&fpid=${a}`:"",n=i?`&fphash=${i}`:"";$.ajax({url:window.formSubmitUrl,type:"post",dataType:"json",data:$("#contactUsForm").serialize()+r+n,success:function(o){e=!1,t.style.display="block",console.log(o.status+" : "+o.desc),"OK"==o.status?(ge("contact_submit_finish"),s.querySelector(".modal-body").innerHTML=o.message,document.querySelector("#contactUsForm").reset()):"ERR02"==o.status?s.querySelector(".modal-body").innerHTML=o.message:s.querySelector(".modal-body").innerHTML=o.message+o.status}}),console.log(o)}),$("#systemInfo").modal({backdrop:"static",keyboard:!1}),$("#systemInfo").modal("show")}}});